(window.webpackJsonp=window.webpackJsonp||[]).push([[19],{344:function(s,t,a){"use strict";a.r(t);var r=a(4),n=Object(r.a)({},(function(){var s=this,t=s._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("h1",{attrs:{id:"_2020-go电商项目-k8s微服务"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2020-go电商项目-k8s微服务"}},[s._v("#")]),s._v(" [2020]Go电商项目+K8s微服务")]),s._v(" "),t("h2",{attrs:{id:"第1章-课程介绍与学习指南"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#第1章-课程介绍与学习指南"}},[s._v("#")]),s._v(" 第1章 课程介绍与学习指南")]),s._v(" "),t("h3",{attrs:{id:"架构图"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#架构图"}},[s._v("#")]),s._v(" 架构图")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.statically.io/gh/famousmai/images/master/imgs/202301191740387.png",alt:"image-20230119122832958"}})]),s._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.statically.io/gh/famousmai/images/master/imgs/202301191740827.png",alt:"image-20230119122846275"}})]),s._v(" "),t("h2",{attrs:{id:"第2章-go微服务介绍与容器化入门"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#第2章-go微服务介绍与容器化入门"}},[s._v("#")]),s._v(" 第2章 Go微服务介绍与容器化入门")]),s._v(" "),t("h3",{attrs:{id:"_2-1-微服务基本介绍"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-1-微服务基本介绍"}},[s._v("#")]),s._v(" 2-1 微服务基本介绍")]),s._v(" "),t("h4",{attrs:{id:"什么是微服务"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#什么是微服务"}},[s._v("#")]),s._v(" 什么是微服务")]),s._v(" "),t("ul",[t("li",[s._v("首先他是一种架构模式")]),s._v(" "),t("li",[s._v("相对单体架构，微服务架构更独立，能够单独更新和发布")]),s._v(" "),t("li",[s._v("微服务里面的服务仅仅用于某一个特定的业务功能")])]),s._v(" "),t("h4",{attrs:{id:"为什么需要微服务"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#为什么需要微服务"}},[s._v("#")]),s._v(" 为什么需要微服务")]),s._v(" "),t("ul",[t("li",[s._v("逻辑清晰")]),s._v(" "),t("li",[s._v("快速迭代")]),s._v(" "),t("li",[s._v("多语言灵活组合")])]),s._v(" "),t("h4",{attrs:{id:"微服务与ddd"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#微服务与ddd"}},[s._v("#")]),s._v(" 微服务与DDD")]),s._v(" "),t("ul",[t("li",[t("p",[s._v("领域驱动设计（Domain Driven Design，简称DDD）")])]),s._v(" "),t("li",[t("p",[s._v("还有个定律：康威定律（Conway‘s Law）")]),s._v(" "),t("blockquote",[t("p",[s._v("组织  ===对应===》 服务拆分")])])])]),s._v(" "),t("h4",{attrs:{id:"ddd作用"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#ddd作用"}},[s._v("#")]),s._v(" DDD作用")]),s._v(" "),t("blockquote",[t("p",[s._v("真正决定软件复杂性的是设计方法")])]),s._v(" "),t("ul",[t("li",[s._v("有助于知道我们确定系统便捷")]),s._v(" "),t("li",[s._v("能够聚焦在系统核心元素上")]),s._v(" "),t("li",[s._v("帮助我们拆分系统")])]),s._v(" "),t("h4",{attrs:{id:"ddd常用概念-领域"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#ddd常用概念-领域"}},[s._v("#")]),s._v(" DDD常用概念 - 领域")]),s._v(" "),t("ul",[t("li",[s._v("领域：是有范围界限的，也可以说是有边界的（电商）")]),s._v(" "),t("li",[s._v("子域（商品、用户、订单、销售等）\n"),t("ul",[t("li",[s._v("核心子域：是业务系统的核心价值（销售）")]),s._v(" "),t("li",[s._v("通用子域：所有子域的消费者，提供者通用服务（短信邮件通知）")]),s._v(" "),t("li",[s._v("支撑子域：专注于业务系统的某一重要的业务（除去销售）")])])])]),s._v(" "),t("h4",{attrs:{id:"ddd常用概念-界限上下文"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#ddd常用概念-界限上下文"}},[s._v("#")]),s._v(" DDD常用概念 - 界限上下文")]),s._v(" "),t("ul",[t("li",[s._v("理解：语文中的语境的意思")]),s._v(" "),t("li",[s._v("方式：领域 + 界限上下文")]),s._v(" "),t("li",[s._v("目的："),t("strong",[s._v("不在于如何划分边界，而在于如何控制边界")])])]),s._v(" "),t("h4",{attrs:{id:"ddd常用概念-领域模型"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#ddd常用概念-领域模型"}},[s._v("#")]),s._v(" DDD常用概念 - 领域模型")]),s._v(" "),t("ul",[t("li",[s._v("理解：领域模型是对我们软件系统中要解决问题的抽象表达")]),s._v(" "),t("li",[s._v("领域：反映的是我们业务上需要解决的问题")]),s._v(" "),t("li",[s._v("模型：我们针对该问题提出的解决方案")])]),s._v(" "),t("h4",{attrs:{id:"ddd域微服务四层架构"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#ddd域微服务四层架构"}},[s._v("#")]),s._v(" DDD域微服务四层架构")]),s._v(" "),t("img",{staticStyle:{zoom:"33%"},attrs:{src:"https://cdn.statically.io/gh/famousmai/images/master/imgs/202301191741552.png",alt:"image-20230119131555679"}}),s._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.statically.io/gh/famousmai/images/master/imgs/202301191741105.png",alt:"image-20230119131630480"}})]),s._v(" "),t("h4",{attrs:{id:"微服务的设计原则"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#微服务的设计原则"}},[s._v("#")]),s._v(" 微服务的设计原则")]),s._v(" "),t("ul",[t("li",[s._v("要领域驱动设计，而不是数据驱动设计，也不是界面驱动设计")]),s._v(" "),t("li",[s._v("要边界清晰的微服务，而不是泥球小单体")]),s._v(" "),t("li",[s._v("要职能清晰的分层，而不是什么都放的大箩筐")]),s._v(" "),t("li",[s._v("要做自己能hold住的微服务，而不是过度拆分的微服务")])]),s._v(" "),t("h3",{attrs:{id:"_2-2-微服务必备技能-docker入门介绍"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-微服务必备技能-docker入门介绍"}},[s._v("#")]),s._v(" 2-2 微服务必备技能 Docker入门介绍")]),s._v(" "),t("h4",{attrs:{id:"为什么需要docker"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#为什么需要docker"}},[s._v("#")]),s._v(" 为什么需要Docker")]),s._v(" "),t("ul",[t("li",[s._v("软件更新发布及部署抵消，过程繁琐且需要人工介入")]),s._v(" "),t("li",[s._v("环境一致性难以保证，不同环境之间迁移成本太高")]),s._v(" "),t("li",[s._v("构建容易分发简单")])]),s._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.statically.io/gh/famousmai/images/master/imgs/202301191741514.png",alt:"image-20230119132418348"}})]),s._v(" "),t("h4",{attrs:{id:"应用场景"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#应用场景"}},[s._v("#")]),s._v(" 应用场景")]),s._v(" "),t("ul",[t("li",[s._v("构建运行环境：统一环境")]),s._v(" "),t("li",[s._v("微服务：部署方便")]),s._v(" "),t("li",[s._v("CI/CD")])]),s._v(" "),t("h4",{attrs:{id:"docker安装"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#docker安装"}},[s._v("#")]),s._v(" Docker安装")]),s._v(" "),t("p",[s._v("略")]),s._v(" "),t("h4",{attrs:{id:"docker的重要概念"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#docker的重要概念"}},[s._v("#")]),s._v(" Docker的重要概念")]),s._v(" "),t("ul",[t("li",[s._v("客户端Client：可运行docker指令")]),s._v(" "),t("li",[s._v("服务器进程（Docker Daemon）：管理镜像和容器")]),s._v(" "),t("li",[s._v("镜像仓库：存储镜像的仓库")])]),s._v(" "),t("p",[t("img",{attrs:{src:"https://i.loli.net/2020/12/15/V4S3yiDK6PCGtbd.png",alt:"img"}})]),s._v(" "),t("h4",{attrs:{id:"docker常用命令"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#docker常用命令"}},[s._v("#")]),s._v(" Docker常用命令")]),s._v(" "),t("ul",[t("li",[s._v("Docker 仓库操作：pull、push")]),s._v(" "),t("li",[s._v("Docker 镜像管理：images、rmi、build")]),s._v(" "),t("li",[s._v("Docker 生命周期管理：run、start、stop、rm")])]),s._v(" "),t("h3",{attrs:{id:"_2-3-go-micro基础之-grpc-proto"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-3-go-micro基础之-grpc-proto"}},[s._v("#")]),s._v(" 2-3 go-micro基础之 grpc proto")]),s._v(" "),t("h4",{attrs:{id:"rpc是什么"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#rpc是什么"}},[s._v("#")]),s._v(" RPC是什么？")]),s._v(" "),t("ul",[t("li",[s._v("RPC代指原远程过程调用（Remote Produce Call）")]),s._v(" "),t("li",[s._v("包含了传输协议和编码（对象序列号）协议")]),s._v(" "),t("li",[s._v("允许运行于一台计算机的程序调用另一台计算机的子程序")])]),s._v(" "),t("h4",{attrs:{id:"使用rpc有什么好处"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#使用rpc有什么好处"}},[s._v("#")]),s._v(" 使用RPC有什么好处？")]),s._v(" "),t("p",[s._v("简单、通用、安全、效率")]),s._v(" "),t("h4",{attrs:{id:"grpc又是什么"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#grpc又是什么"}},[s._v("#")]),s._v(" gRPC又是什么？")]),s._v(" "),t("ul",[t("li",[s._v("gRPC是一个高性能、开源、通用的RPC框架")]),s._v(" "),t("li",[s._v("基于HTTP2.0 协议标准设计开发")]),s._v(" "),t("li",[s._v("支持多语言，默认采用 Protocol Buffers 数据序列化协议")])]),s._v(" "),t("h4",{attrs:{id:"grpc基本调用流程解析"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#grpc基本调用流程解析"}},[s._v("#")]),s._v(" gRPC基本调用流程解析")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.statically.io/gh/famousmai/images/master/imgs/202301191741814.png",alt:"image-20230119134155415"}})]),s._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.statically.io/gh/famousmai/images/master/imgs/202301191741753.png",alt:"image-20230119134212347"}})]),s._v(" "),t("h4",{attrs:{id:"什么是protocol-buffers"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#什么是protocol-buffers"}},[s._v("#")]),s._v(" 什么是Protocol Buffers")]),s._v(" "),t("ul",[t("li",[s._v("是一种轻便高效的徐立华结构化数据的协议")]),s._v(" "),t("li",[s._v("通常用在存储数据和需要远程数据通信的程序上")]),s._v(" "),t("li",[s._v("跨语言、更小、更快、也更简单")])]),s._v(" "),t("h4",{attrs:{id:"为什么要使用protocol-buffers"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#为什么要使用protocol-buffers"}},[s._v("#")]),s._v(" 为什么要使用Protocol Buffers")]),s._v(" "),t("ul",[t("li",[s._v("加速站点之间数据传输速度")]),s._v(" "),t("li",[s._v("解决数据传输不规范问题")])]),s._v(" "),t("h4",{attrs:{id:"protocol-buffers-常用概念"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#protocol-buffers-常用概念"}},[s._v("#")]),s._v(" Protocol Buffers 常用概念")]),s._v(" "),t("ul",[t("li",[s._v("Message定义：描述了一个请求或响应的消息格式")]),s._v(" "),t("li",[s._v("字段标识：消息的定义中，每个字段都有一个唯一的数值标签")]),s._v(" "),t("li",[s._v("常用数据类型：double、float、int32/64、bool、string、bytes")]),s._v(" "),t("li",[s._v("Service 服务定义：在Service中可以定义RPC服务接口")])]),s._v(" "),t("h4",{attrs:{id:"protocol-buffers-message中字段修饰符"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#protocol-buffers-message中字段修饰符"}},[s._v("#")]),s._v(" Protocol Buffers Message中字段修饰符")]),s._v(" "),t("ul",[t("li",[s._v("singular：表示成员有0个或者1个，一般省略不写")]),s._v(" "),t("li",[s._v("repeated：表示该字段可以包含0～N个元素")])]),s._v(" "),t("p",[t("strong",[s._v("类型")])]),s._v(" "),t("p",[s._v("![image-20230119134900217](/Users/mym/Library/Application Support/typora-user-images/image-20230119134900217.png)")]),s._v(" "),t("h4",{attrs:{id:"protocol-buffers-基本语言"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#protocol-buffers-基本语言"}},[s._v("#")]),s._v(" Protocol Buffers 基本语言")]),s._v(" "),t("div",{staticClass:"language-protobuf line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-protobuf"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("syntax")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"proto3"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 版本号")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("package")]),s._v(" go"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("micro"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("service")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("product"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//包名")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("service")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Product")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 定义的服务")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("rpc")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("AddProduct")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("ProductInfo")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("returns")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("ResponseProduct")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 一般不要超过15个，否则开辟两个字节来存储")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("message")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("ProductInfo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 消息格式")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("int64")]),s._v(" id "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("string")]),s._v(" product_name "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("message")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("ResponseProduct")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("int64")]),s._v(" product_id "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br")])]),t("h4",{attrs:{id:"如何在docker中使用protobuf"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#如何在docker中使用protobuf"}},[s._v("#")]),s._v(" 如何在Docker中使用Protobuf")]),s._v(" "),t("p",[s._v("Docker根据 .proto 文件生成微服务文件")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[s._v("$ "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" pull cap1573/cap-protoc\n$ "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" run "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--rm")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-v")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$(")]),t("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("PWD")]),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v(")")])]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token variable"}},[t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$(")]),t("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("PWD")]),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v(")")])]),s._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-w")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$(")]),t("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("PWD")]),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v(")")])]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n\t"),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-e")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("ICODE")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("CF388DF1EF1C5EB cap1573/cap-protoc "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n\t"),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-I")]),s._v(" ./ "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--go_out")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("./ "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--micro_out")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("./ ./*proto\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br")])]),t("p",[s._v("命令说明")]),s._v(" "),t("ul",[t("li",[s._v("$(PWD) ：当前目录")]),s._v(" "),t("li",[s._v("--rm：运行完删除")]),s._v(" "),t("li",[s._v("-e ICODE=CF388DF1EF1C5EB：带一个环境变量，"),t("code",[s._v("CF388DF1EF1C5EB")]),s._v("是慕课教程码")])]),s._v(" "),t("h3",{attrs:{id:"_2-4-go-micro-组件架构及通讯原理"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-4-go-micro-组件架构及通讯原理"}},[s._v("#")]),s._v(" 2-4 go-micro 组件架构及通讯原理")]),s._v(" "),t("h4",{attrs:{id:"micro是什么"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#micro是什么"}},[s._v("#")]),s._v(" Micro是什么")]),s._v(" "),t("ul",[t("li",[s._v("是用来构建和管理分布式程序的系统")]),s._v(" "),t("li",[s._v("Runtime（运行时）：用来管理配置，认证，网络等")]),s._v(" "),t("li",[s._v("Framework（程序开发框架）：用来方便编写微服务")]),s._v(" "),t("li",[s._v("Clients（多语言客户端）：支持多语言访问服务端")])]),s._v(" "),t("h4",{attrs:{id:"micro-其中-runtime-运行时-介绍"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#micro-其中-runtime-运行时-介绍"}},[s._v("#")]),s._v(" Micro 其中 Runtime（运行时）介绍")]),s._v(" "),t("ul",[t("li",[s._v("他是工具集，工具名称是“micro”")]),s._v(" "),t("li",[s._v("官方 docker 版本是 dokcer pull micro/micro")]),s._v(" "),t("li",[s._v("课程扩展版本是 dokcer pull cap1573/cap-micro")])]),s._v(" "),t("h4",{attrs:{id:"micro-其中-runtime-运行时-组成"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#micro-其中-runtime-运行时-组成"}},[s._v("#")]),s._v(" Micro 其中 Runtime（运行时）组成")]),s._v(" "),t("ul",[t("li",[s._v("api：api网关")]),s._v(" "),t("li",[s._v("broker：允许异步消息的消息代理")]),s._v(" "),t("li",[s._v("network：通过微网络服务构建多云网络（不常用，知道就好）")]),s._v(" "),t("li",[s._v("new：服务模版生成器")]),s._v(" "),t("li",[s._v("proxy：建立在Go Micro上的透明服务代理")]),s._v(" "),t("li",[s._v("registry：一个服务资源管理器")]),s._v(" "),t("li",[s._v("store：简单的状态存储")]),s._v(" "),t("li",[s._v("web：Web仪表板允许您浏览器服务")])]),s._v(" "),t("h4",{attrs:{id:"micro-其中-framework-go-micro-介绍"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#micro-其中-framework-go-micro-介绍"}},[s._v("#")]),s._v(" Micro 其中 Framework（go-micro）介绍")]),s._v(" "),t("ul",[t("li",[s._v("它是对分布式系统的高度抽象")]),s._v(" "),t("li",[s._v("提供分布式系统开发的核心库")]),s._v(" "),t("li",[s._v("可插拔的架构，按需使用")])]),s._v(" "),t("h4",{attrs:{id:"micro-其中-framework-go-micro-组件"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#micro-其中-framework-go-micro-组件"}},[s._v("#")]),s._v(" Micro 其中 Framework（go-micro）组件")]),s._v(" "),t("ul",[t("li",[s._v("注册（Registry）：提供了服务发现机制")]),s._v(" "),t("li",[s._v("选择器（Selector）：能够实现负载均衡")]),s._v(" "),t("li",[s._v("传输（Transport）：服务与服务之间通信接口")]),s._v(" "),t("li",[s._v("Broker：提供异步通信的消息发布/订阅接口")]),s._v(" "),t("li",[s._v("编码（Codec）：消息传输到两端时进行编码与解码")]),s._v(" "),t("li",[s._v("Server（服务端）、Client（客户端）")])]),s._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.statically.io/gh/famousmai/images/master/imgs/202301191741466.png",alt:"image-20230119153536466"}})]),s._v(" "),t("h4",{attrs:{id:"micro-其中-framework-go-micro-通信图"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#micro-其中-framework-go-micro-通信图"}},[s._v("#")]),s._v(" Micro 其中 Framework（go-micro）通信图")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.statically.io/gh/famousmai/images/master/imgs/202301191741059.png",alt:"image-20230119153654264"}})]),s._v(" "),t("h3",{attrs:{id:"_2-5-go-micro-入门案例编写"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-5-go-micro-入门案例编写"}},[s._v("#")]),s._v(" 2-5 go-micro 入门案例编写")]),s._v(" "),t("p",[s._v("参考：https://github.com/go-micro/generator")]),s._v(" "),t("h4",{attrs:{id:"_1-编写proto文件"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-编写proto文件"}},[s._v("#")]),s._v(" 1. 编写proto文件")]),s._v(" "),t("div",{staticClass:"language-protobuf line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-protobuf"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("syntax")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"proto3"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("option")]),s._v(" go_package "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"./;cap"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("package")]),s._v(" go"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("micro"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("service")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("imooc"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("service")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Cap")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("rpc")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("SayHello")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("SayRequest")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("returns")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("SayResponse")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("message")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("SayRequest")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("string")]),s._v(" message "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("message")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("SayResponse")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("string")]),s._v(" answer "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br")])]),t("h4",{attrs:{id:"_2-下载-protoc-gen-micro"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-下载-protoc-gen-micro"}},[s._v("#")]),s._v(" 2. 下载 protoc-gen-micro")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[s._v("go get github.com/go-micro/generator/cmd/protoc-gen-micro\ngo "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" github.com/go-micro/generator/cmd/protoc-gen-micro\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("div",{staticClass:"custom-block tip"},[t("p",{staticClass:"custom-block-title"},[s._v("注意")]),s._v(" "),t("p",[s._v("注意 protoc-gen-micro 的版本和 go-micro 的版本要对应，否则生成的代码，使用会报错")])]),s._v(" "),t("h4",{attrs:{id:"_3-生成服务文件"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-生成服务文件"}},[s._v("#")]),s._v(" 3. 生成服务文件")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[s._v("protoc "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--plugin")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("protoc-gen-micro"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$GOPATH")]),s._v("/bin/protoc-gen-micro "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--go_out")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("./newmicro/proto/cap "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--micro_out")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("./ewmicro/proto/cap   ./newmicro/proto/cap/*proto \n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("h4",{attrs:{id:"_4-编写服务端"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4-编写服务端"}},[s._v("#")]),s._v(" 4. 编写服务端")]),s._v(" "),t("div",{staticClass:"language-go line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-go"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("package")]),s._v(" main\n\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("\n\t"),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"context"')]),s._v("\n\t"),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"fmt"')]),s._v("\n\t"),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"go-micro.dev/v4"')]),s._v("\n\timooc "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"go-project-shop/newmicro/proto/cap"')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("type")]),s._v(" CapServer "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("struct")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// SayHello 需要实现的方法")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("func")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("c "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v("CapServer"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("SayHello")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("ctx context"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Context"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" req "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v("imooc"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("SayRequest"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" res "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v("imooc"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("SayResponse"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("error")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n\tres"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Answer "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"冲冲冲:"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" req"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Message\n\n\t"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("nil")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("func")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("main")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n\t"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 创建新的服务")]),s._v("\n\tservice "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":=")]),s._v(" micro"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("NewService")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("\n\t\tmicro"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("Name")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"cap.imooc.server"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n\t"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n\t"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 初始化")]),s._v("\n\tservice"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("Init")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n\t"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 注册服务")]),s._v("\n\terr "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":=")]),s._v(" imooc"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("RegisterCapHandler")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("service"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("Server")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("new")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("CapServer"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\t"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" err "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("nil")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n\t\tfmt"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("Println")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("err"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\t\t"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v("\n\t"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n\t"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 运行服务")]),s._v("\n\t"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" err "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":=")]),s._v(" service"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("Run")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" err "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("nil")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n\t\tfmt"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("Println")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("err"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\t"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br"),t("span",{staticClass:"line-number"},[s._v("26")]),t("br"),t("span",{staticClass:"line-number"},[s._v("27")]),t("br"),t("span",{staticClass:"line-number"},[s._v("28")]),t("br"),t("span",{staticClass:"line-number"},[s._v("29")]),t("br"),t("span",{staticClass:"line-number"},[s._v("30")]),t("br"),t("span",{staticClass:"line-number"},[s._v("31")]),t("br"),t("span",{staticClass:"line-number"},[s._v("32")]),t("br"),t("span",{staticClass:"line-number"},[s._v("33")]),t("br"),t("span",{staticClass:"line-number"},[s._v("34")]),t("br"),t("span",{staticClass:"line-number"},[s._v("35")]),t("br"),t("span",{staticClass:"line-number"},[s._v("36")]),t("br"),t("span",{staticClass:"line-number"},[s._v("37")]),t("br"),t("span",{staticClass:"line-number"},[s._v("38")]),t("br"),t("span",{staticClass:"line-number"},[s._v("39")]),t("br")])]),t("h4",{attrs:{id:"_5-编写客户端"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_5-编写客户端"}},[s._v("#")]),s._v(" 5. 编写客户端")]),s._v(" "),t("div",{staticClass:"language-go line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-go"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("package")]),s._v(" main\n\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("\n\t"),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"context"')]),s._v("\n\t"),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"fmt"')]),s._v("\n\t"),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"go-micro.dev/v4"')]),s._v("\n\timooc "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"go-project-shop/newmicro/proto/cap"')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("func")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("main")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n\n\tservice "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":=")]),s._v(" micro"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("NewService")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("\n\t\tmicro"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("Name")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"cap.imooc.client"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n\t"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n\tservice"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("Init")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n\tcapImooc "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":=")]),s._v(" imooc"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("NewCapService")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"cap.imooc.server"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" service"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("Client")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n\tres"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" err "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":=")]),s._v(" capImooc"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("SayHello")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("context"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("TODO")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v("imooc"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("SayRequest"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n\t\tMessage"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"全场由老麦买单！"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n\t"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" err "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("nil")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n\t\tfmt"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("Println")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("err"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\t"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\tfmt"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("Println")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("res"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Answer"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br"),t("span",{staticClass:"line-number"},[s._v("26")]),t("br"),t("span",{staticClass:"line-number"},[s._v("27")]),t("br")])]),t("h2",{attrs:{id:"第3章-微服务模块开发"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#第3章-微服务模块开发"}},[s._v("#")]),s._v(" 第3章 微服务模块开发")]),s._v(" "),t("h3",{attrs:{id:"_3-1-micro-new-和-项目目录创建"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-1-micro-new-和-项目目录创建"}},[s._v("#")]),s._v(" 3-1 micro new 和 项目目录创建")]),s._v(" "),t("h3",{attrs:{id:"_3-2-go-mod-私有化设置-和-gorm-说明"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-2-go-mod-私有化设置-和-gorm-说明"}},[s._v("#")]),s._v(" 3-2 go mod 私有化设置 和 gorm 说明")]),s._v(" "),t("h3",{attrs:{id:"_3-3-编写proto并自动生成代码"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-3-编写proto并自动生成代码"}},[s._v("#")]),s._v(" 3-3 编写proto并自动生成代码")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[s._v("protoc "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--plugin")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("protoc-gen-micro"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$GOPATH")]),s._v("/bin/protoc-gen-micro "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--go_out")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("./user/proto/user "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--micro_out")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("./user/proto/user   ./user/proto/user/user.proto \n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("h3",{attrs:{id:"_3-4-domain对数据库和模型进行操作"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-4-domain对数据库和模型进行操作"}},[s._v("#")]),s._v(" 3-4 domain对数据库和模型进行操作")]),s._v(" "),t("h3",{attrs:{id:"_3-5-编写handel要暴露的服务"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-5-编写handel要暴露的服务"}},[s._v("#")]),s._v(" 3-5 编写Handel要暴露的服务")]),s._v(" "),t("h3",{attrs:{id:"_3-6-go-micro开发流程梳理"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-6-go-micro开发流程梳理"}},[s._v("#")]),s._v(" 3-6 go-micro开发流程梳理")]),s._v(" "),t("h3",{attrs:{id:"_3-7-dockerfile-打包-user-功能"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-7-dockerfile-打包-user-功能"}},[s._v("#")]),s._v(" 3-7 dockerfile 打包 user 功能")]),s._v(" "),t("h3",{attrs:{id:"_3-8-章节小结"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-8-章节小结"}},[s._v("#")]),s._v(" 3-8 章节小结")]),s._v(" "),t("h3",{attrs:{id:"第4章"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#第4章"}},[s._v("#")]),s._v(" 第4章")])])}),[],!1,null,null,null);t.default=n.exports}}]);